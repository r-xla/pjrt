% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/loaded_executable.R
\name{pjrt_execute_async}
\alias{pjrt_execute_async}
\title{Execute a PJRT program asynchronously}
\usage{
pjrt_execute_async(executable, ..., execution_options = NULL, simplify = TRUE)
}
\arguments{
\item{executable}{(\code{PJRTLoadedExecutable})\cr
A PJRT program.}

\item{...}{(\code{PJRTBuffer} | \code{pjrt_async_value} | \code{pjrt_async_transfer})\cr
Inputs to the program.
Named are ignored and arguments are passed in order.}

\item{execution_options}{(\code{PJRTExecuteOptions})\cr
Optional execution options for configuring buffer donation and other settings.}

\item{simplify}{(\code{logical(1)})\cr
If \code{TRUE} (default), a single output is returned as a \code{PJRTBuffer}.
If \code{FALSE}, a single output is returned as a \code{list} of length 1 containing a \code{PJRTBuffer}.}
}
\value{
A \code{pjrt_async_value} object (or list of them if multiple outputs).
Call \code{value()} to get the \code{PJRTBuffer}.
}
\description{
Execute a PJRT program asynchronously with the given inputs.
Returns immediately with async value(s) that can be awaited later.

Use \code{value()} to get the result (blocks if not ready).
Use \code{is_ready()} to check if execution has completed (non-blocking).
Use \code{as_array_async()} to chain async buffer-to-host transfer.

Inputs can be \code{PJRTBuffer} objects or async values (\code{pjrt_async_value},
\code{pjrt_async_transfer}). Async inputs are automatically awaited before execution.
}
\examples{
\dontshow{if (plugin_is_downloaded()) withAutoprint(\{ # examplesIf}
# Create and compile a simple program
src <- r"(
func.func @main(\%x: tensor<2x2xf32>) -> tensor<2x2xf32> {
  "func.return"(\%x): (tensor<2x2xf32>) -> ()
}
)"
prog <- pjrt_program(src = src)
exec <- pjrt_compile(prog)

# Execute asynchronously
x <- pjrt_buffer(c(1.0, 2.0, 3.0, 4.0), shape = c(2, 2), dtype = "f32")
result <- pjrt_execute_async(exec, x)

# Check if ready (non-blocking)
is_ready(result)

# Get the result (blocks if not ready)
value(result)

# Chain with async buffer-to-host transfer
arr <- as_array_async(result)
value(arr)
\dontshow{\}) # examplesIf}
}
\seealso{
\code{\link[=pjrt_execute]{pjrt_execute()}}, \code{\link[=value]{value()}}, \code{\link[=is_ready]{is_ready()}}, \code{\link[=as_array_async]{as_array_async()}}, \code{\link[=pjrt_buffer_async]{pjrt_buffer_async()}}
}
