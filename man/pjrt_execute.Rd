% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/loaded_executable.R
\name{pjrt_execute}
\alias{pjrt_execute}
\title{Execute a PJRT program}
\usage{
pjrt_execute(executable, ..., execution_options = NULL, simplify = TRUE)
}
\arguments{
\item{executable}{(\code{PJRTLoadedExecutable})\cr
A PJRT program.}

\item{...}{(\code{PJRTBuffer} | \code{pjrt_buffer_promise})\cr
Inputs to the program.
Named are ignored and arguments are passed in order.}

\item{execution_options}{(\code{PJRTExecuteOptions})\cr
Optional execution options for configuring buffer donation and other settings.}

\item{simplify}{(\code{logical(1)})\cr
If \code{TRUE} (default), a single output is returned as a \code{PJRTBuffer}.
If \code{FALSE}, a single output is returned as a \code{list} of length 1 containing a \code{PJRTBuffer}.}
}
\value{
\code{PJRTBuffer} | \code{list} of \code{PJRTBuffer}s
}
\description{
Execute a PJRT program with the given inputs and execution options.

\strong{Important:}
Arguments are passed by position and names are ignored.

Inputs can be \code{PJRTBuffer} objects or buffer promises (\code{pjrt_buffer_promise}).
Buffer promises are resolved automatically before execution.
}
\examples{
\dontshow{if (plugin_is_downloaded()) withAutoprint(\{ # examplesIf}
# Create and compile a simple identity program
src <- r"(
func.func @main(
  \%x: tensor<2x2xf32>,
  \%y: tensor<2x2xf32>
) -> tensor<2x2xf32> {
  \%0 = "stablehlo.add"(\%x, \%y) : (tensor<2x2xf32>, tensor<2x2xf32>) -> tensor<2x2xf32>
  "func.return"(\%0): (tensor<2x2xf32>) -> ()
}
)"
prog <- pjrt_program(src = src)
exec <- pjrt_compile(prog)

# Execute with input
x <- pjrt_buffer(c(1.0, 2.0, 3.0, 4.0), shape = c(2, 2), dtype = "f32")
y <- pjrt_buffer(c(5, 6, 7, 8), shape = c(2, 2), dtype = "f32")
pjrt_execute(exec, x, y)
\dontshow{\}) # examplesIf}
}
